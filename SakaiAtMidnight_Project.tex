\documentclass{article} % For LaTeX2e
\usepackage{nips15submit_e,times}
\usepackage{hyperref}
\usepackage{url}
%\documentstyle[nips14submit_09,times,art10]{article} % For LaTeX 2.09


\title{SakaiAtMidnight 521 Final Project}


\author{
  Leonardo Shu\\
  Department of Statistics\\
  Duke University\\
  Durham, NC \\
  \texttt{leonardo.shu@duke.edu} \\
  \And
  Mengrun Li \\
  Department of Statistics\\
  Duke University\\
  Durham, NC \\
  \texttt{mengrun.li@duke.edu} \\
  \AND
  Yaqian Cheng \\
  Department of Statistics\\
  Duke University\\
  Durham, NC \\
  \texttt{yaqian.cheng@duke.edu} \\
  \And
  Wei (Emily) Shao \\
  Department of Statistics\\
  Duke University\\
  Durham, NC \\
  \texttt{wei.shao@duke.edu} \\
}


\newcommand{\fix}{\marginpar{FIX}}
\newcommand{\new}{\marginpar{NEW}}

\nipsfinalcopy % Uncomment for camera-ready version

\begin{document}


\maketitle

\begin{abstract}
This article is a proposal with preliminary ideas and plans for our final project. We choose a data set of NCAA basketball and hope to predict the champion of the 2015 NCAA tournament. We have come up with some motivation questions about selecting variables and considering time effect. According to the details of the data set and what we have learned from the course, we plan to use regression with bayesian approaches and do classification or clustering to achieve our goal.
\end{abstract}

\section{Introduction}

The topic of our team final project is predicting the results of the various NCAA tournaments with a variety of models and compare the results between them. This is quite a popular excercise done every year during March Madness but there is still alot of debate as to the best method of prediction apart from blind guessing and being biased for one's favourite team. Some papers have been written about this sort of problem, most notably by Prof.....

The data sets we will be using are provided by a past competition on Kaggle.com, which ensures that we are using information which is both reliable and rich enough for our project goals. The data sets have detailed information on past NCAA regular seasons, tournaments, along with seeds and ID's for each team to facilitate prediction match-ups. Specifically, there are more than 5000 pieces of game data for each year, including 34 columns of relevant game statstics for each playing team such as field goals made, number of blocks, number of steals and number of assists, which will be essential for us to measure a team's performance.

Using the data described above we will build several models that will attempt to predict the tournament's entire bracket. To start with, we will have several types of models that will be applied to various years. For example, the LASSO logistic regression model will be trained separately with regular season data for each year from 2012-2015 in order to predict that respective year's edition of the tournament. Looking back in hindsight, we already know the resulting brackets of past tournaments so we can easily rate how our predictions did with a complete set of results.

Since predicting tournament brackets is still a huge conundrum and even now betting sites and competitions never look exactly for "perfect" brackets, we also did not want to assess our predictions solely on this measure. As a result, we are going to divide our predictions into different levels of accuracy where we see how our model performs in predicting the entire bracket, the Final Four (Regional champions) and the National champion.

\section{Data Cleaning/Manipulation}

Even though we avoid issues of missing or messy data by using data provided by Kaggle, there was still alot of manipulation to do in order to get the data in appropriate form for our needs. Our most important function is the one that predicts the tournament bracket. This function starts out predicting the first 32 games of the first round, then it progressively predicts each subsequent round, making sure each game has the correct teams (E.g The winner between seed 1 and seed 16 of region W must play the winner between seeds 8 and 9 of the same region). To do so we needed to ensure each touranment seed was associated with their correct seed and that the games were ordered correctly (NOTE: Due to the varying nature of the preliminary First Four round, we just take its winners as given).

Another issue we encountered was that the data was structured in such a way that the statistics recorded per game were categorized for winning team and losing team. The problem arises in that when we create the binary response variable Y, all the values would be by default 1 and this would be problematic when we build our models. Thus, we had to create functions that removed the winning and losing labels to the more generic "a", "b" and then exchange the columns in the data frame so the winning team could be either the first or second input.

Once our model is completed, the inputs for each team will be the regular season averages for both teams so we needed a function to extract and compute this information.

The details of these functions and edits can be checked on the appendix.

\section{Motivating Questions}

\subsection{Question 1}

Teams in the NCAA change rosters very quickly which means that historical data of past seasons/tournaments has diminishing returns. For example, how useful will be the results of a season that happened 12 years ago in predicting this year's results when all the teams players (possibly coaches) may be completely different. Therefore, we want to know how useful and to what extent should we use historical data in our analysis.


\subsection{Question 2}

Another question is how useful are each individual game metric to our model? Are number of overtimes in a game really significant for our predictions? One way we might want to tune our model is by using backwards-step methods to identify the best model to use.



\subsection{Question 3}

As we use the model to predict the historical results of tournament in 2015 and test how well our model performs, we also want to know whether this model can potentially predict results of tournament in 2016. If the model we build is robust and works for future prediction, once regular season results in 2016 comes out in future, we are interested to know whether the prediction will still be valid, or whether we need to revise our model to adjust for any variability in the data.


%% \subsection{Keywords for paper submission}
%% Your NIPS paper can be submitted with any of the following keywords (more than one keyword is possible for each paper):
  
  %% \begin{verbatim}
%% Bioinformatics
%% Biological Vision
%% Brain Imaging and Brain Computer Interfacing
%% Clustering
%% Cognitive Science
%% Control and Reinforcement Learning
%% Dimensionality Reduction and Manifolds
%% Feature Selection
%% Gaussian Processes
%% Graphical Models
%% Hardware Technologies
%% Kernels
%% Learning Theory
%% Machine Vision
%% Margins and Boosting
%% Neural Networks
%% Neuroscience
%% Other Algorithms and Architectures
%% Other Applications
%% Semi-supervised Learning
%% Speech and Signal Processing
%% Text and Language Applications

%% \end{verbatim}

\section{Methods}
\label{gen_inst}

Our model is going to predict the all the games in multiple editions of the NCAA Basketball tournaments. The logistic regression model will be trained by using data from the regular season of that tournament's year. Each game in the tournament will be predicted by using the average seasonal performance of both teams. Since for every tournament will already know the starting bracket, we can predict each game's result form the first round and use our model to progressively fill in the whole tournament bracket, we then evaluate our model's performance by seeing how it matches the true events. We repeat this procedure for multiple tournaments.

While we worked on this project we realized that it would be extremely unlikely to predict every single game correctly so we changed our focus to predict at different levels of accuracy. This means that in addition to predicting the whole bracket, we also assess our models' performances based on how they predicted each round of the tournament from the First Round to the National Championship final.




\subsection{Model Analysis}

We start out with our full logistic model $Y_{ab} = X_{ab}^T \beta$ where:\
\[ Y_{ab} = \left\{
  \begin{array}{ll}
  1 & Team \ a \ wins \\
  0 &  Team \ b \ wins \\
  \end{array} 
  \right. \]\
Meanwhile X is a matrix of all 32 relevant statistics for teams a and b, with each row indicating one game in the regular season of the year in question. Finally, $\beta$ is also a vector of the corresponding cofficients for each column of X.\

Now we can run this model with LASSO regression and (10-fold) cross-validation to obtain the most significant covariates and start checking the predictions.\

Checking the non-zero coefficients after running the LASSO, we can see some surprising results. 
First of all, the coefficients for each team are either significant or not in pairs. Which means that there is no case where assists for team a are important but assists for team b are not. Second, the final scores for each team at the end of each game are not relevant enough to be used which is quite unintuitive since these numbers logically determine the winner of the game but on at least we don not have to worry now that such a statistic would cause overfitting issues to our model. Conversely, we note that number of overtimes in a game does in fact influence our model, it's a small, negative effect, but significant nonetheless given that our prior assumptions would say otherwise. \

Other interesting features from this model selection include the idea that field goals or 3-pointers attempted are not significant, only the ones that are actually made are important. This is important since this means that no tying harder to shoot does not imply a better chance at winning if the shots do not go in. However, this doesn't apply to free-throws since both those that are made and attempted are significant but this could be because free-throws are closely connected to fouls made which is another statistic of our data which is also impactful. Moreover, defensive rebounds are significant unlike their offensive counterparts while the coefficients for turnovers, steals and blocks are pushed to 0 which again is something noteworthy since they usually have a lot of attention in regular game analysis.\

\subsection{Model Analysis}

Bayesian GLM Stepwise:

In this step we apply stepwise method to select significant coefficients using results from running Bayesian Generalized Linear Model. The Bayesian model assumes an independent normal prior for each coefficient and performs MCMC algorithm to search for posterior of each coeffiecient. Then we select the most significant coefficients calculated by Bayesian GLM using stepwise method with both directions.

In the Bayesian GLM stage, each posterior coefficient has an estimated value. However, after applying stepwise method, number of the most important coefficients results in only six, less than that from LASSO regression. It turns out that three pointers made, field goals made, free throw attempted, free throws made are the most essential winning features for a team as the coefficients values are quite large. Interestingly the results that final scores of both teams are not significant which is consistent with the results from LASSO. Similary in the stepwise analysis, free throws made are significant, which also agrees with the LASSO results.








\section{Predictions}

\subsection{Model 1: Logistic Regression with Lasso}

\subsection{Model 2: Logistic Regression with Ridge}

\subsection{Model 3: Bayesian Generalized Linear Model with Stepwise}

Below are the results of our predictions for the last 4 NCAA tournaments:\





\subsection{Account for Team Specifics and Upsets}

To account for team specifics and upsets that our model has not explained, we examine the history of every paired teams in the 2015 bracket and record the information whether they have played in regular seasons between 2003 and 2014. Since most of times two teams in different regions did not play against each other in regular seasons, out of 67 games, only 19 games have happened in the regular seasons during the past 12 years. For every paired game in the bracket, we use the following formula to compute proportion of strong seed A beat weak seed B conditional on occurences when strong seed A and weak seed B played in the past:

$P=\frac{Number \ of \ times \ strong \ seed \ A \ won \ - \ Number \ of \ times \ weak \ seed \ B \ won}{Number \ of \ times \ strong \ seed \ A \ met \ weak \ seed \ B }$


The results are shown in the table below. 14 out of 19 times historical records indicates consistency with actual tournament results. The historical result somewhat explains an upset in our model prediction when the historical data shows Villanova were beat by NC State in 2008 which is consistent with the actual tournament results, while our model predicts Villanova to win and show up in the final four. 

This further suggests that if we want to incorporate team specifics into our model to make our model more accurate, in each step after we apply the model to select two teams that will play in the bracket, we would look into the regular season information to determine whether strong seed A will beat weak seed B. However, since the past information does not always inform the future, we could possibily assign weights to teams in our regression model to adjust for the possibility of an upset that may happen. 

Tim Chartier, author of \textit{Bracketology: How can math help?} focuses more on team specifics to predict brackets as an example is that scores team A beats B by is related to ratings of Team A and Team B. This leaves us more inspirations to revise our model in the future. 

% latex table generated in R 3.2.2 by xtable 1.8-0 package
% Mon Nov 23 16:47:50 2015
\begin{table}[ht]
\centering
\begin{tabular}{rrrrrrrrr}
  \hline
 & W & W3L1 & W1L2 & W1L1 & L & Correct & Games played & Correct proportion \\ 
  \hline
1 & 9.00 & 1.00 & 1.00 & 2.00 & 6.00 & 14.00 & 19.00 & 0.74 \\ 
   \hline
\end{tabular}

\caption{W: Strong seed A always beat weak seed B; W3L1: Strong seed A won three times as it was beat by weak seed B; W1L2: Strong seed A was beat by weak seed B as twice as it beat weak seed B; W1L1: Strong seed A won as many times as it was beat by weak seed B; Correct: Historical results consistent with actual tournament results; Games played: number of games played; Correct Proportion: Proportion that historical results are consistent with actual tournament results}
\end{table}









\section{Model 2: Logistic Regression with Elastic Net}
\section{Model 3: Blasso}








\section{References $\&$ Data Links}
http://mathaware.org/mam/2010/essays/ChartierBracketology.pdf

https://www.kaggle.com/c/march-machine-learning-mania-2015

\end{document}