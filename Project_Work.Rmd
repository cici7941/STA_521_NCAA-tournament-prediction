---
title: "Project Work"
author: "SakaiAtMidnight"
date: "November 4, 2015"
output: pdf_document
---

We load the data:
```{r}
library(glmnet)
teams = read.csv("teams.csv")
seasons = read.csv("seasons.csv")
compactR = read.csv("regular_season_compact_results.csv")
#detailedR
compactT = read.csv("tourney_compact_results.csv")
detailedT = read.csv("tourney_detailed_results.csv")
detailedR = read.csv("regular_season_detailed_results.csv")
```

Subset 2014 info:
```{r}
regSeason2014 = compactR[which(compactR$season == 2014),]
tourney2014 = compactT[which(compactT$season == 2014),]
regSeason2014D = detailedR[which(detailedR$season == 2014),]
tourney2014D = detailedT[which(detailedT$season == 2014),]
exchange <- function(data){
  result <- 0
  #data <- cbind(data, result)
  for(i in 1: nrow(data)){
    if (data$wteam[i] > data$lteam[i]){
      result[i] <- 0
      temp <- data$wteam[i]
      data$wteam[i] <- data$lteam[i]
      data$lteam[i] <- temp
      temp.vec <- data[i, 9:21]
      data[i, 9:21] <- data[i, 22:34]
      data[i, 22:34] <- temp.vec
    }
    else{
      result[i] <-1
    }
  }
  return(cbind(data, result))
}
datanew <- exchange(regSeason2014D)
names(datanew)
datanew = datanew[, -c(1, 2, 3, 5, 7)]
datanewS = as.data.frame(scale(datanew))
datanewS = datanewS[, -30]
datanewS = cbind(datanewS, datanew$result)
datanewS=as.matrix(datanewS)
lm1 = cv.glmnet(datanewS[,1:29], datanewS[,30], standardize=FALSE, family = "binomial",alpha = 1)
plot(lm1)
coef=coef(lm1)
coef=as.numeric(coef)
index=which(coef!=0)
datanewS.1=as.data.frame(cbind(datanewS[,index], datanewS[,30]))
datanewS.1=datanewS.1[,-20]
colnames(datanewS.1)[19]="result"
lm2=glm(result~., data = datanewS.1, family = "binomial"(link = "logit"))
summary(lm2)

```
